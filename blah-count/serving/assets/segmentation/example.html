<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Segmentation</title>
    <style>
      .chart { height: 400px; width: 600px }
      .line { fill: none; stroke-width: 2px }
      .area { stroke: none; opacity: 0.2 }
      .chart { position: relative }
      .tooltip {
        position: absolute;
        pointer-events: none;
        width: 120px;
        background: #eee;
        padding: 5px;
        font-size: 12px;
      }
    </style>
  </head>

  <body>
    <div id="segmentation"></div>

    <script src="../../node_modules/moment/min/moment.min.js"></script>
    <script src="../../node_modules/xhr-mock/bundle.js"></script>

    <script>
      var browserFamilyResponse = JSON.stringify([{
        count: 10,
        date: moment().subtract(1, 'hour').toISOString(),
        browserFamily: 'Chrome'
      }])
      var platformResponse = JSON.stringify([{
        count: 20,
        date: moment().subtract(2, 'hour').toISOString(),
        platform: 'Mobile'
      }])
      XhrMock.setup()
      XhrMock.post('http://localhost:8080/count', function(req, res) {
        var body = req.body().indexOf('user_agent.browser.family') > -1 ?
          browserFamilyResponse : platformResponse
        return res.status(200).body(body)
      })
    </script>

    <script src="../../dist/segmentation.js"></script>

    <script>
      var events = {on: function() {}}
      var elem = document.getElementById('segmentation')
      var comp = new Segmentation(elem, events, {
        baseUrl: 'http://localhost:8080',
        collection: 'view',
        title: 'Example',
        groups: ['date.year', 'date.month', 'date.day', 'date.hour'],
        groupBy: ['date.hour'],
        from: moment().subtract(1, 'day').toISOString(),
        to: moment().add(1, 'hour').toISOString(),
        segments: [
          {filterBy:[]}
        ]
      })
    </script>
  </body>
</html>
